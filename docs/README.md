# Malware Incident Management:

This is a malware incident management use case. The choronoly goes as follows

- Data exfiltration alert is created
- Enrich device details from CMDB
- Identify the logged in user on the target machine
- Hunt the malware process name
- Fetch and analyse the malware binary and extract indicators from it
- Find all infected devices via the malware file hash
- Investigate patient zero and the payload delivery method
- Remediation actions

## Installation:
Within FortiSOAR UI, browse to `Content Hub` and search for `Malware Incident Management`. Open the Solution Pack and click `Install`

## Configuration:
- Make sure the SOAR Framework enrichment is configured, you will need a couple of Threat Intel configured for better results. Typically FortiGuard and VirusTotal should be configured. For more details about SOAR Framework Enrichment click [here](https://github.com/fortinet-fortisoar/solution-pack-soar-framework/blob/release/2.0.2/docs/moving-to-sfsp-2-0-2.md)

- The solution pack is designed to run in demo mode with mockout data, make sure the global variable `Demo_mode` is set to `true`.
- If you want to use the solution pack in production you will need to adapt it to your environment by modifying the playbooks to match your available integrations.

## Content:
- Playbooks:
   -  Create Exfiltration Alert
   -  01 - Get Device Details
   -  02 - Get Logged On User
   -  03 - Hunt Exfiltration Process
   -  04 - Fetch and Analyze Exfiltration Process
   -  05 - Escalate Alert To Incident
   -  06 - Hunt Lateral Movement
   -  07 - Identify and Fetch Delivery Indicators
   -  08 - Malware Incident Remediation
   -  Exfiltration Alert Investigation
   -  | Malware Incident Remediation
   -  | Get Logged On User
   -  | Run SIEM Search Querying and Fetch Dropper File
   -  | Hunt Hashcode On All Devices
   -  | Escalate Alert to Incident
   -  | Set Incident Status Comment Status
   -  | Add Escalation Comment
   -  | Download Exfiltration Process
   -  | Set Alert Status Comment Status
   -  | Update Last Task Comment
   -  | Extract Indicators from Binary File
   -  | Hunt Exfiltration Process Name
   -  | Get Device Details From CMDB
   -  | User Indicator AD Enrichment

## Usage:

- You can run the scenario by either:
    - Browse to `Simulations > Malware Incident Management` then click the `Simulate Scenario` button
    - Run the playbook: `Create Exfiltration Alert` from `Incident Response > Alerts > Execute` to create the simulation alert
- Follow the instructions on the `Workspace > comments` section

![](scenario_guide.png)