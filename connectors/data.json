[
    {
        "name": "fortinet-fortiguard-threat-intelligence",
        "label": "Fortinet FortiGuard Threat Intelligence",
        "category": "Threat Intelligence",
        "description": "FortiGuard Threat Intelligence is the global threat intelligence and research organization at Fortinet. This connector facilitates automated operations to check IP, URL, Domain and File Hash Lookup\u2019s and ingestion of daily threat feeds.<br\/><br\/>This connector has a dependency on the <a href=\"\/content-hub\/all-content\/?contentType=solutionpack&amp;tag=ThreatIntelManagement\" target=\"_blank\" rel=\"noopener\">Threat Intel Management Solution Pack<\/a>. Install the Solution Pack before enabling ingestion of Threat Feeds from this source.",
        "publisher": null,
        "operation_roles": [],
        "configurations": [
            {
                "id": 71,
                "config_id": "e02562a9-a719-4081-ac83-3dfebbb66422",
                "status": 1,
                "name": "Default Configuration",
                "default": false,
                "config": {
                    "server_url": "https:\/\/productapi.fortinet.com"
                },
                "remote_status": [],
                "health_status": [],
                "connector": 123,
                "agent": "8355670b19299e1ce94d9af29604cd65",
                "teams": []
            }
        ],
        "dataImports": [
            {
                "id": 16,
                "name": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                "description": "Metadata for Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                "status": null,
                "created_by": "3451141c-bac6-467c-8d72-85e0fab569ce",
                "modified_by": "3451141c-bac6-467c-8d72-85e0fab569ce",
                "owners": [
                    "public"
                ],
                "data_mapping": [],
                "playbooks": [],
                "created_at": "2022-11-03T16:33:00.991254Z",
                "modified_at": "2022-11-03T16:33:00.991303Z",
                "metadata": {
                    "scheduleId": "gAAAAABjY-08IYbN4WhBA8h23pt2SvT-n8293sb7iO3RgAeM8y2QKEPAnHRfdHe1YZb8qFkYNDn9mxDI4wGzjDtEFk2ZEmkEow==",
                    "scheduleName": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                    "scheduleStatus": true
                },
                "configuration": "e02562a9-a719-4081-ac83-3dfebbb66422",
                "schedule": {
                    "id": "gAAAAABjoVz_LHNPqEFsmpdgPy0LVNksJ1UgpwVXOKVzcPdzr7iajLa4q-0RsqZOGH9P3OAQAQdFmZDNxDkmhcgMXzUZxBXu7w==",
                    "crontab": {
                        "id": 4,
                        "minute": "0",
                        "hour": "*\/1",
                        "day_of_week": "*",
                        "day_of_month": "*",
                        "month_of_year": "*",
                        "timezone": "UTC"
                    },
                    "interval": null,
                    "name": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                    "task": "workflow.tasks.periodic_task",
                    "args": "[]",
                    "kwargs": {
                        "exit_if_running": true,
                        "wf_iri": "\/api\/3\/workflows\/26191d34-e980-40b0-bfc1-0e7bfb04dab5",
                        "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                        "name": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                        "description": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                        "auth": {
                            "auth_method": "CS HMAC"
                        },
                        "referenceid": null,
                        "schedule_entry_name": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                        "schedule_id": "f5821b18-3c23-4cd3-a6f8-b1d9812ed221"
                    },
                    "queue": null,
                    "exchange": null,
                    "routing_key": null,
                    "headers": "{}",
                    "priority": 3,
                    "expires": null,
                    "expire_seconds": null,
                    "one_off": false,
                    "start_time": null,
                    "enabled": true,
                    "last_run_at": "2022-12-20T06:00:00.035808Z",
                    "total_run_count": 1118,
                    "date_changed": "2022-12-20T06:01:00.034296Z",
                    "description": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                    "solar": null,
                    "clocked": null
                }
            }
        ],
        "install_mode": "rpm",
        "ingestionPlaybooks": {
            "collections": [
                {
                    "@context": "\/api\/3\/contexts\/WorkflowCollection",
                    "@type": "WorkflowCollection",
                    "name": "Fortinet FortiGuard Threat Intelligence 3.1.0 config2Ingestion(e02562a9-a719-4081-ac83-3dfebbb66422)",
                    "description": null,
                    "visible": false,
                    "workflows": [
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "FortiGuard Threat Intelligence > Ingest",
                            "aliasName": null,
                            "tag": null,
                            "description": null,
                            "isActive": true,
                            "debug": false,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/e02562a9-a719-4081-ac83-3dfebbb66422",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/f2110a7d-8ed9-46af-a6fe-408188e1dfea",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Fetch and Create",
                                    "description": null,
                                    "arguments": {
                                        "name": "Fortinet FortiGuard Threat Intelligence",
                                        "config": "e02562a9-a719-4081-ac83-3dfebbb66422",
                                        "params": {
                                            "output_mode": "Create as Feed Records in FortiSOAR",
                                            "create_pb_id": "c55b179b-9869-4de7-a129-7fadadd92b9d",
                                            "modified_after": "{{vars.lastPullTime}}"
                                        },
                                        "version": "3.1.0",
                                        "connector": "fortinet-fortiguard-threat-intelligence",
                                        "operation": "ingest_feeds",
                                        "operationTitle": "Fetch Threat Intel Feeds",
                                        "pickFromTenant": false,
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "570",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
                                    "group": null,
                                    "uuid": "1cee1665-bdda-47d0-9ade-7bd8f0d8c470"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Get Macro Value",
                                    "description": null,
                                    "arguments": {
                                        "params": {
                                            "iri": "\/api\/wf\/api\/dynamic-variable\/?name={{vars.pullTimeMacro}}",
                                            "body": "",
                                            "method": "GET"
                                        },
                                        "version": "3.1.2",
                                        "connector": "cyops_utilities",
                                        "operation": "make_cyops_request",
                                        "operationTitle": "FSR: Make FortiSOAR API Call",
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                                    "group": null,
                                    "uuid": "207b9938-3625-46d3-a68d-8538b4ed5031"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Extract Value from Response",
                                    "description": null,
                                    "arguments": {
                                        "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}0{% endif %}"
                                    },
                                    "status": null,
                                    "top": "435",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "9049fa06-7be9-4f0e-b2b9-0b9114a1ab15"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Update Pull Time",
                                    "description": null,
                                    "arguments": {
                                        "params": {
                                            "macro": "{{vars.pullTimeMacro}}",
                                            "value": "{{vars.fetchTime}}"
                                        },
                                        "version": "3.1.2",
                                        "connector": "cyops_utilities",
                                        "operation": "updatemacro",
                                        "operationTitle": "CyOPs: Update Macro",
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "705",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                                    "group": null,
                                    "uuid": "bed2b056-a82b-4cb3-b922-b19875d85511"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "fetchTime": "{{arrow.utcnow().int_timestamp}}",
                                        "pullTimeMacro": "FortiguardIntelligenceLastPullTime__{{vars['audit_info']['cyops_playbook_iri'].split('\/')[-1].replace('-','_')}}"
                                    },
                                    "status": null,
                                    "top": "165",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "c5f6f4ea-98d7-4837-8676-47de31c15970"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "step_variables": {
                                            "input": {
                                                "params": []
                                            }
                                        }
                                    },
                                    "status": null,
                                    "top": "30",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                                    "group": null,
                                    "uuid": "f2110a7d-8ed9-46af-a6fe-408188e1dfea"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Get Macro Value",
                                    "targetStep": "\/api\/3\/workflow_steps\/207b9938-3625-46d3-a68d-8538b4ed5031",
                                    "sourceStep": "\/api\/3\/workflow_steps\/c5f6f4ea-98d7-4837-8676-47de31c15970",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "036001ba-3751-4b0b-825f-43709be352b5"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Fetch and Create -> Update Pull Time",
                                    "targetStep": "\/api\/3\/workflow_steps\/bed2b056-a82b-4cb3-b922-b19875d85511",
                                    "sourceStep": "\/api\/3\/workflow_steps\/1cee1665-bdda-47d0-9ade-7bd8f0d8c470",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "183c4ca2-bc19-410c-b832-a5926931f32a"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/c5f6f4ea-98d7-4837-8676-47de31c15970",
                                    "sourceStep": "\/api\/3\/workflow_steps\/f2110a7d-8ed9-46af-a6fe-408188e1dfea",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "9a898f24-99aa-4186-8439-fe40284eadd2"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Extract Value from Response -> Fetch and Create",
                                    "targetStep": "\/api\/3\/workflow_steps\/1cee1665-bdda-47d0-9ade-7bd8f0d8c470",
                                    "sourceStep": "\/api\/3\/workflow_steps\/9049fa06-7be9-4f0e-b2b9-0b9114a1ab15",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "a8ca5b91-d803-41c8-be02-b00641a66def"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Get Macro Value -> Extract Value from Response",
                                    "targetStep": "\/api\/3\/workflow_steps\/9049fa06-7be9-4f0e-b2b9-0b9114a1ab15",
                                    "sourceStep": "\/api\/3\/workflow_steps\/207b9938-3625-46d3-a68d-8538b4ed5031",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "d11e16fb-a95f-4efc-901e-f40ffbf3d00e"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "26191d34-e980-40b0-bfc1-0e7bfb04dab5",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "ingest",
                                "fortinet-fortiguard-threat-intelligence"
                            ],
                            "schedules": [
                                {
                                    "id": "gAAAAABjoVz_f4EY-MsuRQJRMbswZRDnuJ3nrrYs34zT6sAPZAmmE2jjJMh6ZifbaBfzYH5s_mOQQJJjq5yYvMPMT2o1eUHj-A==",
                                    "crontab": {
                                        "id": 4,
                                        "minute": "0",
                                        "hour": "*\/1",
                                        "day_of_week": "*",
                                        "day_of_month": "*",
                                        "month_of_year": "*",
                                        "timezone": "UTC"
                                    },
                                    "interval": null,
                                    "name": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                                    "task": "workflow.tasks.periodic_task",
                                    "args": "[]",
                                    "kwargs": {
                                        "exit_if_running": true,
                                        "wf_iri": "\/api\/3\/workflows\/26191d34-e980-40b0-bfc1-0e7bfb04dab5",
                                        "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                        "name": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                                        "description": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                                        "auth": {
                                            "auth_method": "CS HMAC"
                                        },
                                        "referenceid": null,
                                        "schedule_entry_name": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                                        "schedule_id": "f5821b18-3c23-4cd3-a6f8-b1d9812ed221"
                                    },
                                    "queue": null,
                                    "exchange": null,
                                    "routing_key": null,
                                    "headers": "{}",
                                    "priority": 3,
                                    "expires": null,
                                    "expire_seconds": null,
                                    "one_off": false,
                                    "start_time": null,
                                    "enabled": true,
                                    "last_run_at": "2022-12-20T06:00:00.035808Z",
                                    "total_run_count": 1118,
                                    "date_changed": "2022-12-20T06:01:00.034296Z",
                                    "description": "Ingestion_fortinet-fortiguard-threat-intelligence_config2_e02562a9-a719-4081-ac83-3dfebbb66422",
                                    "solar": null,
                                    "clocked": null
                                }
                            ]
                        },
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "> FortiGuard Threat Intelligence > Fetch and Create",
                            "aliasName": null,
                            "tag": null,
                            "description": null,
                            "isActive": true,
                            "debug": true,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [
                                "ingestedData"
                            ],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/e02562a9-a719-4081-ac83-3dfebbb66422",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/ca67cc2e-64ae-4629-b850-b27b2d011dc5",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Create Record",
                                    "description": null,
                                    "arguments": {
                                        "for_each": {
                                            "item": "{{vars.input.params.ingestedData}}",
                                            "__bulk": true,
                                            "parallel": false,
                                            "condition": "",
                                            "batch_size": 8000
                                        },
                                        "resource": {
                                            "tLP": "{{vars.tlp_resolved}}",
                                            "label": "{{vars.item.labels | toJSON}}",
                                            "value": "{{ vars.item.name.split(\": \")[1].strip() }}",
                                            "source": "FortiGuard Threat Intelligence",
                                            "created": "{% if vars.item.created %}{{arrow.get(vars.item.created).int_timestamp}}{% endif %}",
                                            "pattern": "{{vars.item.pattern | toJSON}}",
                                            "modified": "{% if vars.item.modified %}{{arrow.get(vars.item.modified).int_timestamp}}{% endif %}",
                                            "sourceId": "{{ vars.item.id.split(\"--\")[-1] }}",
                                            "__replace": "true",
                                            "expiresOn": "{% if vars.expiry %}{% if vars.item.valid_from %}{{ arrow.get(vars.item.valid_from).int_timestamp + (vars.expiry | int)*24*60*60 }}{% else %}None{% endif %}{% endif %}",
                                            "validFrom": "{% if vars.item.valid_from %}{{arrow.get(vars.item.valid_from).int_timestamp}}{% endif %}",
                                            "confidence": "{% if vars.item.confidence %}{{ vars.item.confidence }}{% else %}{{ vars.confidence }}{% endif %}",
                                            "recordTags": "{% if vars.item.labels | length > 1 %}{{ vars.item.labels[1].split(\"tags:\")[-1].split(\",\") }}{% endif %}",
                                            "reputation": "{{vars.reputation_resolved}}",
                                            "sourceData": "{{ vars.item | toJSON}}",
                                            "typeOfFeed": "{{ vars.item.name.split(\": \")[0].strip() | resolveRange(vars.typeOfFeed_map) }}",
                                            "validUntil": "{% if vars.item.valid_until %}{{arrow.get(vars.item.valid_until).int_timestamp}}{% else %}None{% endif %}",
                                            "description": "<p>{{ vars.item.description }}<\/p>",
                                            "threatTypes": "{% if vars.item.labels and 'threat_types' in vars.item.labels[0] %}{%set types=[] %}{% for type in vars.item.labels[0].split(\"threat_types:\")[-1].split(\",\") %}{% set _temp=types.append(type | resolveRange(vars.threatTypes_map)) %}{% endfor %}{{types}}{% else %}None{% endif %}",
                                            "killChainPhases": "{% if vars.item.kill_chain_phases %}['{{ vars.item.kill_chain_phases[0].phase_name | resolveRange(vars.killChainPhases_map) }}']{% else %}None{% endif %}"
                                        },
                                        "_showJson": false,
                                        "collection": "\/api\/ingest-feeds\/threat_intel_feeds",
                                        "__recommend": [],
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "460",
                                    "left": "980",
                                    "stepType": "\/api\/3\/workflow_step_types\/7b221880-716b-4726-a2ca-5e568d330b3e",
                                    "group": null,
                                    "uuid": "2072b79a-023d-40fe-b345-91fe6b686535"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Is data only for mapping",
                                    "description": null,
                                    "arguments": {
                                        "conditions": [
                                            {
                                                "option": "Yes, For Mapping",
                                                "step_iri": "\/api\/3\/workflow_steps\/adcb2a4e-286c-4090-8bf0-00d81c641346",
                                                "condition": "{{ vars.request.env_setup == true }}",
                                                "step_name": "Return Sample Data"
                                            },
                                            {
                                                "option": "No, For Ingestion",
                                                "default": true,
                                                "step_iri": "\/api\/3\/workflow_steps\/2072b79a-023d-40fe-b345-91fe6b686535",
                                                "step_name": "Create Record"
                                            }
                                        ]
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "620",
                                    "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
                                    "group": null,
                                    "uuid": "280a4d24-e2bf-4848-bf32-ec53a2d3c4ca"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "tlp": "Amber",
                                        "expiry": 7,
                                        "tlp_map": "{'Red': {{'TrafficLightProtocol' | picklist('Red', 'uuid')}}','Amber':{{'TrafficLightProtocol' | picklist('Amber', 'uuid')}}','Green':{{'TrafficLightProtocol' | picklist('Green','uuid')}},'White': {{'TrafficLightProtocol' | picklist('White', 'uuid')}}}",
                                        "confidence": "50",
                                        "reputation": "Suspicious",
                                        "reputation_map": "{'Good': \"{{'IndicatorReputation' | picklist('Good', 'uuid')}}\",'Suspicious': \"{{'IndicatorReputation' | picklist('Suspicious', 'uuid')}}\",'Malicious': \"{{'IndicatorReputation' | picklist('Malicious', 'uuid')}}\",'No Reputation Available': \"{{'IndicatorReputation' | picklist('No Reputation Available', 'uuid')}}\",'TBD': \"{{'IndicatorReputation' | picklist('TBD', 'uuid')}}\"}",
                                        "typeOfFeed_map": "{'domain': \"{{'ThreatIntelFeedType' | picklist('Domain', 'uuid')}}\",'url': \"{{'ThreatIntelFeedType' | picklist('URL', 'uuid')}}\", 'ip_port': \"{{'ThreatIntelFeedType' | picklist('Network Activity', 'uuid')}}\",'ip': \"{{'ThreatIntelFeedType' | picklist('IP Address', 'uuid')}}\", 'file_hash_sha256': \"{{'ThreatIntelFeedType' | picklist('FileHash-SHA256', 'uuid')}}\",'file_hash_sha1': \"{{'ThreatIntelFeedType' | picklist('FileHash-SHA1', 'uuid')}}\", 'file_hash_md5': \"{{'ThreatIntelFeedType' | picklist('FileHash-MD5', 'uuid')}}\"}",
                                        "threatTypes_map": "{\"anonymization\": \"{{'Threat Type' | picklist('Anonymization', 'uuid')}}\", 'bot': \"{{'Threat Type' | picklist('Bot', 'uuid')}}\", 'cc_skimming': \"{{'Threat Type' | picklist('Credit Card Skimming', 'uuid')}}\", 'cryptocurrency_mining': \"{{'Threat Type' | picklist('Cryptocurrency Mining', 'uuid')}}\", 'malware': \"{{'Threat Type' | picklist('Malware', 'uuid')}}\", 'malware_cnc': \"{{'Threat Type' | picklist('Malware C2', 'uuid')}}\", 'phishing': \"{{'Threat Type' | picklist('Phishing', 'uuid')}}\",'pup': \"{{'Threat Type' | picklist('Potential Unwanted Program (PUP)', 'uuid')}}\", 'pup_cnc': \"{{'Threat Type' | picklist('PUP Spyware C2', 'uuid')}}\", 'scanner': \"{{'Threat Type' | picklist('Scanner', 'uuid')}}\", 'spam_sender': \"{{'Threat Type' | picklist('Spam Sender', 'uuid')}}\", 'spam_url': \"{{'Threat Type' | picklist('Spam URL', 'uuid')}}\", 'potential_malware': \"{{'Threat Type' | picklist('Potential Malware', 'uuid')}}\", 'potential_phishing': \"{{'Threat Type' | picklist('Potential Phishing', 'uuid')}}\", 'potential_spam': \"{{'Threat Type' | picklist('Potential Spam', 'uuid')}}\"}",
                                        "killChainPhases_map": "{\"reconnaissance\": \"{{'KillChainPhases' | picklist('Reconnaissance', 'uuid')}}\", \"weaponization\": \"{{'KillChainPhases' | picklist('Weaponization', 'uuid')}}\", \"delivery\": \"{{'KillChainPhases' | picklist('Delivery', 'uuid')}}\", \"exploitation\": \"{{'KillChainPhases' | picklist('Exploitation', 'uuid')}}\", \"installation\": \"{{'KillChainPhases' | picklist('Installation', 'uuid')}}\", \"command-and-control\": \"{{'KillChainPhases' | picklist('Command & Control', 'uuid')}}\", \"actions-on-objectives\": \"{{'KillChainPhases' | picklist('Actions on Objectives', 'uuid')}}\"}",
                                        "threat_intel_feeds_tLP_map": "{}",
                                        "threat_intel_feeds_reputation_map": "{}",
                                        "threat_intel_feeds_typeOfFeed_map": "{}"
                                    },
                                    "status": null,
                                    "top": "120",
                                    "left": "240",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "38d14302-02b8-4b45-a0a3-49f763373003"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Resolve Range",
                                    "description": null,
                                    "arguments": {
                                        "tlp_resolved": "{{vars.tlp | resolveRange(vars.tlp_map)}}",
                                        "reputation_resolved": "{{vars.reputation | resolveRange(vars.reputation_map)}}"
                                    },
                                    "status": null,
                                    "top": "200",
                                    "left": "420",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "97fb943f-4247-479d-9beb-4a6f2d624be5"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Return Sample Data",
                                    "description": null,
                                    "arguments": {
                                        "data": "[{\n\t\"id\": \"indicator--10566256-faa2-5e44-803f-d2fc2c8a5c93\",\n\t\"name\": \"ip: 45.83.64.186\",\n\t\"description\": \"threat_types:scanner; tags:Log4Shell,CVE-2021-44228,Scanner,Log4j RCE,Log4j\",\n\t\"pattern\": \"[ipv4-addr:value = '45.83.64.186']\",\n\t\"labels\": [\"threat_types:scanner\", \"tags:Log4Shell,CVE-2021-44228,Scanner,Log4j RCE,Log4j\"],\n\t\"confidence\": 50,\n\t\"created\": \"2021-12-13T18:38:53Z\",\n\t\"modified\": \"2022-03-16T07:39:35Z\",\n\t\"valid_from\": \"2021-12-13T18:38:53Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"exploitation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--15d51b54-2ba8-5caf-8757-cdc20f315611\",\n\t\"name\": \"ip: 213.91.181.117\",\n\t\"description\": \"threat_types:scanner; tags:Scanner\",\n\t\"pattern\": \"[ipv4-addr:value = '213.91.181.117']\",\n\t\"labels\": [\"threat_types:scanner\", \"tags:Scanner\"],\n\t\"confidence\": 50,\n\t\"created\": \"2021-11-23T02:49:27Z\",\n\t\"modified\": \"2022-03-16T07:39:31Z\",\n\t\"valid_from\": \"2021-11-23T02:49:27Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"exploitation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--0b76df10-f988-5626-ab6b-12ca62f3a682\",\n\t\"name\": \"url: http:\/\/180.182.225.138:48148\/Mozi.a\",\n\t\"description\": \"threat_types:malware; tags:Mozi,Elf\",\n\t\"pattern\": \"[url:value = 'http:\/\/180.182.225.138:48148\/Mozi.a']\",\n\t\"labels\": [\"threat_types:malware\", \"tags:Mozi,Elf\"],\n\t\"confidence\": 85,\n\t\"created\": \"2022-03-16T07:00:32Z\",\n\t\"modified\": \"2022-03-16T07:00:35Z\",\n\t\"valid_from\": \"2022-03-16T07:00:32Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"installation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--04cecdb1-9f41-5bcb-a3e6-f1847f0c711f\",\n\t\"name\": \"url: http:\/\/27.41.52.101:37688\/Mozi.m\",\n\t\"description\": \"threat_types:malware; tags:Mozi,Elf\",\n\t\"pattern\": \"[url:value = 'http:\/\/27.41.52.101:37688\/Mozi.m']\",\n\t\"labels\": [\"threat_types:malware\", \"tags:Mozi,Elf\"],\n\t\"confidence\": 85,\n\t\"created\": \"2022-03-16T07:00:32Z\",\n\t\"modified\": \"2022-03-16T07:00:35Z\",\n\t\"valid_from\": \"2022-03-16T07:00:32Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"installation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--2416e87c-0c73-5e5d-b5bf-b8423ce47419\",\n\t\"name\": \"domain: babacocpoo.duckdns.org\",\n\t\"description\": \"threat_types:malware,phishing; tags:Phishing,Apple phishing,MoqHao\",\n\t\"pattern\": \"[domain-name:value = 'babacocpoo.duckdns.org']\",\n\t\"labels\": [\"threat_types:malware,phishing\", \"tags:Phishing,Apple phishing,MoqHao\"],\n\t\"confidence\": 85,\n\t\"created\": \"2022-03-16T08:52:49Z\",\n\t\"modified\": \"2022-03-16T08:52:49Z\",\n\t\"valid_from\": \"2022-03-16T08:52:49Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"exploitation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n}]"
                                    },
                                    "status": null,
                                    "top": "140",
                                    "left": "980",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "adcb2a4e-286c-4090-8bf0-00d81c641346"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "step_variables": {
                                            "input": {
                                                "params": []
                                            },
                                            "_configuration_schema": "[\n  {\n    \"title\": \"Confidence\",\n    \"name\": \"confidence\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default Confidence score to be set for the feeds, in case the feed record doesn't have a confidence score\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 50,\n    \"validation\": {\n       \"minlength\": 0,\n       \"maxlength\": 100\n    }\n  },\n  {\n    \"title\": \"Reputation\",\n    \"name\": \"reputation\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default Reputation to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Good\", \"Suspicious\", \"Malicious\", \"No Reputation Available\", \"TBD\"],\n    \"value\": \"Suspicious\"\n  },\n  {\n    \"title\": \"TLP\",\n    \"name\": \"tlp\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default TLP to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Red\", \"Amber\", \"Green\", \"White\"],\n    \"value\": \"White\"\n  },\n{\n    \"title\": \"Maximum Age (in days)\",\n    \"name\": \"expiry\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default age for the feeds. The indicator expires on 'valid_until' date unless a different expiry is specified here. If specified, the indicator will be marked expired on valid_from + expiry.\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 7\n  }\n]"
                                        }
                                    },
                                    "status": null,
                                    "top": "40",
                                    "left": "40",
                                    "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                                    "group": null,
                                    "uuid": "ca67cc2e-64ae-4629-b850-b27b2d011dc5"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Resolve Range",
                                    "targetStep": "\/api\/3\/workflow_steps\/97fb943f-4247-479d-9beb-4a6f2d624be5",
                                    "sourceStep": "\/api\/3\/workflow_steps\/38d14302-02b8-4b45-a0a3-49f763373003",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "0c4ba25a-5904-41fd-aac9-c032a4bfed1d"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/38d14302-02b8-4b45-a0a3-49f763373003",
                                    "sourceStep": "\/api\/3\/workflow_steps\/ca67cc2e-64ae-4629-b850-b27b2d011dc5",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "344665d7-e718-432a-a4b5-f90f905ba5ed"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Is data only for mapping -> Copy  of Create Record",
                                    "targetStep": "\/api\/3\/workflow_steps\/2072b79a-023d-40fe-b345-91fe6b686535",
                                    "sourceStep": "\/api\/3\/workflow_steps\/280a4d24-e2bf-4848-bf32-ec53a2d3c4ca",
                                    "label": "No, For Ingestion",
                                    "isExecuted": false,
                                    "uuid": "371387f6-d9fa-4996-acdc-d05661e6fdf1"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Is data only for mapping -> Return Sample Data",
                                    "targetStep": "\/api\/3\/workflow_steps\/adcb2a4e-286c-4090-8bf0-00d81c641346",
                                    "sourceStep": "\/api\/3\/workflow_steps\/280a4d24-e2bf-4848-bf32-ec53a2d3c4ca",
                                    "label": "Yes, For Mapping",
                                    "isExecuted": false,
                                    "uuid": "824e1bff-b109-44e2-bbac-ff435d98008e"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Resolve Range -> Is data only for mapping",
                                    "targetStep": "\/api\/3\/workflow_steps\/280a4d24-e2bf-4848-bf32-ec53a2d3c4ca",
                                    "sourceStep": "\/api\/3\/workflow_steps\/97fb943f-4247-479d-9beb-4a6f2d624be5",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "945152e5-58e8-40d4-ab2e-39677ddf810d"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "c55b179b-9869-4de7-a129-7fadadd92b9d",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "create",
                                "fetch",
                                "fortinet-fortiguard-threat-intelligence"
                            ]
                        }
                    ],
                    "image": null,
                    "uuid": "e02562a9-a719-4081-ac83-3dfebbb66422",
                    "deletedAt": null,
                    "recordTags": []
                }
            ],
            "exported_tags": [
                "dataingestion",
                "ingest",
                "fortinet-fortiguard-threat-intelligence",
                "create",
                "fetch"
            ],
            "globalVariables": []
        }
    },
    {
        "name": "ssh",
        "label": "SSH",
        "category": "utilities",
        "description": "Steps that use an ssh connection. Including sftp and remote code execution",
        "publisher": null,
        "operation_roles": [],
        "configurations": [
            {
                "id": 65,
                "config_id": "2376db8a-a4e8-4fdc-81d2-e73fc8e6118d",
                "status": 1,
                "name": "localhost",
                "default": true,
                "config": {
                    "host": "127.0.0.1",
                    "port": "22",
                    "timeout": 10,
                    "password": "ivLjy1yGUoWrQfxvfmcA091jhGhmR9lBI3dmcn23@KlS2#!ck",
                    "username": "csadmin",
                    "private_key": "",
                    "super_user_password": ""
                },
                "remote_status": [],
                "health_status": [],
                "connector": 112,
                "agent": "8355670b19299e1ce94d9af29604cd65",
                "teams": []
            }
        ],
        "dataImports": [],
        "install_mode": "rpm",
        "ingestionPlaybooks": {
            "collections": [],
            "exported_tags": [],
            "globalVariables": []
        }
    }
]